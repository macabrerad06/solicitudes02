<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core">

<h:head>
    <title>Panel principal</title>
    <h:outputStylesheet library="css" name="style.css" />
</h:head>

<h:body>

    <!-- Llama a loginBean.verificarSesion() antes de dibujar la vista -->
    <f:metadata>
        <f:event type="preRenderView" listener="#{loginBean.verificarSesion}" />
    </f:metadata>
    <div class="dashboard">
	    <aside class="sidebar">
	    	<div class="sidebar-header">
                <h:graphicImage library="img" name="logo.png"
                                styleClass="sidebar-logo"
                                alt="Logo" />
                <h3>Sistema de Solicitudes</h3>
            </div>
            
            <nav class="sidebar-nav">
                <ul id="menu">
                    <li><a href="#">Inicio</a></li>

                    <!-- ITEM 2 - solo si es ANALISTA -->
                    <h:panelGroup rendered="#{loginBean.usuario.cargo eq 'Analista'}">
                        <li><a href="#">Solicitudes pendientes</a></li>
                        <li><a href="#">Revisión de documentos</a></li>
                    </h:panelGroup>

                    <!-- ITEM 3 - solo si es ADMIN -->
                    <h:panelGroup rendered="#{loginBean.usuario.cargo eq 'Administrador'}">
                        <li><a href="#">Gestión de Usuarios</a></li>
                        <li><a href="#">Asignación de Roles</a></li>
                        <li><a href="#">Auditoría del Sistema</a></li>
                    </h:panelGroup>

                    <!-- ITEM 4 - solo si es DIRECTOR -->
                    <h:panelGroup rendered="#{loginBean.usuario.cargo eq 'Director'}">
                        <li><a href="#">Reportes</a></li>
                        <li><a href="#">Indicadores Generales</a></li>
                    </h:panelGroup>

                    <!-- ITEM 5 - visible para todos -->
                    <li><a href="#">Mi Perfil</a></li>
                </ul>
            </nav>
            <!-- Botón de logout usando JSF -->
            <h:form id="logoutForm">
                <h:commandButton id="logoutBtn"
                                 value="Cerrar Sesión"
                                 action="#{loginBean.logout}"
                                 styleClass="btn-logout"
                                 ajax="false" />
            </h:form>
	    </aside>
	    
	    <main class="main-content">

            <header class="main-header">
                <h2>
                    Bienvenido,
                    #{loginBean.usuario.nombre}
                    #{loginBean.usuario.apellido}
                </h2>
                <p>
                    Correo: #{loginBean.usuario.correo}
                    
                    Cargo: #{loginBean.usuario.cargo}
                </p>
            </header>

            <section class="content">
                <div class="card">
                    <h3>Resumen General</h3>
                    <p>El contenido se ajustará según el rol del usuario.</p>
                </div>
            </section>

        </main>
    </div>

   
</h:body>
</html>
